<div class="row">
  <div class="col-md-12">
    <h1 class="page-header"><%= @retail_plan.name %></h1>
  </div>
</div>


<p><b>Start Date: </b><%= @retail_plan.start_date%></p>
<p><b>End Date: </b><%= @retail_plan.end_date%></p>
<p><b>Expected Expiry Date: </b><%= @retail_plan.expected_expiry_date%></p>
<p><b>Discount: </b><%= @retail_plan.discount%></p>

<div class="row">
  <div class="col-md-8">
    <h3>Daily Usage Charge</h3>
    <table class="table table-bordered table-hover">
      <thead class="active">
      <th>Name</th>
      <th>Unit Of Measurement</th>
      <th>Rate</th>
      <th>Start Time</th>
      <th>End Time</th>
      </thead>

      <tbody>
      <% @retail_plan.daily_usage_charges.each do |factory| %>
          <tr>
              <td><%= factory.name %></td>         
              <td><%= factory.unit_of_measurement %></td>
              <td><%= factory.rate %></td>
              <td><%= factory.start_time.strftime('%I:%M %p') %></td>
              <td><%= factory.end_time.strftime('%I:%M %p') %></td>  
          </tr>
      <% end %>

      </tbody>
    </table>

    <h3>Global Usage Charge</h3>
    <table class="table table-bordered table-hover">
      <thead>
      <th>Name</th>
      <th>Unit Of Measurement</th>
      <th>Rate</th>
      </thead>
      <tbody>
      <% @retail_plan.global_usage_charges.each do |factory| %>
          <tr>
              <td><%= factory.name %></td>
              <td><%= factory.unit_of_measurement %></td>
              <td><%= factory.rate %></td>
          </tr>
      <% end %>
      </tbody>
    </table>

    <h3>Capacity Charge</h3>
    <table class="table table-bordered table-hover">
      <thead>
        <th>Name</th>
        <th>Unit Of Measurement</th>
        <th>Rate</th>
        <th>Period</th>
      </thead>
      <tbody>
      <% @retail_plan.capacity_charges.each do |factory| %>
          <tr>
              <td><%= factory.name %></td>
              <td><%= factory.unit_of_measurement %></td>
              <td><%= factory.rate %></td>
              <td><%= factory.period %></td>
          </tr>
      <% end %>
      </tbody>
    </table>

    <h3>Certificate Charge</h3>
    <table class="table table-bordered table-hover">
      <thead>
        <th>Name</th>
        <th>Unit Of Measurement</th>
        <th>Rate</th>
      </thead>
      <tbody>
      <% @retail_plan.certificate_charges.each do |factory| %>
          <tr>
              <td><%= factory.name %></td>
              <td><%= factory.unit_of_measurement %></td>
              <td><%= factory.rate %></td>
          </tr>
      <% end %>
      </tbody>
    </table>

    <h3>Metering Charge</h3>
    <table class="table table-bordered table-hover">
       <thead>
       <th>Name</th>
       <th>Rate</th>
       </thead>
       <tbody>
       <% @retail_plan.metering_charges.each do |factory| %>
       <tr>
           <td><%= factory.name %></td>
           <td><%= factory.rate %></td>
       </tr>
       <% end %>
    </tbody>
    </table>

    <h3>Supply Charge</h3>
    <table class="table table-bordered table-hover">
      <thead>
      <th>Name</th>
      <th>Rate</th>
      </thead>
      <tbody>
      <% @retail_plan.supply_charges.each do |factory| %>
          <tr>
              <td><%= factory.name %></td>
              <td><%= factory.rate %></td>
          </tr>
      <% end %>
      </tbody>
    </table>


    <!-- debug -->
    <% if false %>
    <h3>DailyUsageCharge</h3>
    <table>
      <thead>
      <th>Name</th>
      <th>Rate</th>

      <th> Unit Of Measurement</th>
      <th>Start Time</th>
      <th>End Time</th>
      </thead>

      <tbody>
      <% @retail_plan.charge_factories.each do |factory| %>
          <tr>
            <% if factory.specific.is_a?(DailyUsageCharge) %>
              <td><%= factory.name %></td>
              <td><%= factory.rate %></td>
              <td><%= factory.specific.unit_of_measurement %></td>
              <td><%= factory.specific.start_time %></td>
              <td><%= factory.specific.end_time%></td>
            <% end %>
          </tr>
      <% end %>

      </tbody>
    </table>

    <h3>GlobalUsageCharge</h3>
    <table>
      <thead>
      <th>Name</th>
      <th>Rate</th>

      <th> Unit Of Measurement</th>
      </thead>
      <tbody>
      <% @retail_plan.charge_factories.each do |factory| %>
          <tr>
            <% if factory.specific.is_a?(GlobalUsageCharge) %>
              <td><%= factory.name %></td>
              <td><%= factory.rate %></td>
              <td><%= factory.specific.unit_of_measurement %></td>
            <% end %>
          </tr>
      <% end %>
      </tbody>
    </table>


    <h3>MeteringCharge</h3>
    <table>
       <thead>
       <th>Name</th>
       <th>Rate</th>
       </thead>
       <tbody>
       <% @retail_plan.charge_factories.each do |factory| %>
       <tr>
         <% if factory.specific.is_a?(MeteringCharge) %>
           <td><%= factory.name %></td>
           <td><%= factory.rate %></td>
         <% end %>
       </tr>
       <% end %>
    </tbody>
    </table>

    <h3>SupplyCharge</h3>
    <table>
      <thead>
      <th>Name</th>
      <th>Rate</th>
      </thead>
      <tbody>
      <% @retail_plan.charge_factories.each do |factory| %>
          <tr>
            <% if factory.specific.is_a?(SupplyCharge) %>
              <td><%= factory.name %></td>
              <td><%= factory.rate %></td>
            <% end %>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>



<%if false%>
    <!-- From Billing_2 - Go to index after creating a retail plan-->
<%= link_to "Back to Index", billing_site_retail_plans_path(@retail_plan.billing_site_id) %>
    <div>
      <%= link_to 'Back to your Billing Site', billing_sites_url%>
      </br>
    </div>
<%end%>

<% end %>
<!-- debug end -->


